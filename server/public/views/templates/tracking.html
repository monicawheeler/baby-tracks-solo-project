<header class="header" ng-include="'/views/partials/header.html'"></header>
<div ng-include="'views/partials/nav.html'"></div>

<div class="track-wrapper">
    <h2 class="input-alert alert-danger" role="alert" ng-if="vm.message != ''">{{vm.message}}</h2>
    <div class="input-row">
        <select class="select input" ng-change="vm.getChildEventList(vm.trackChild.id)" ng-model="vm.trackChild" ng-options="child as child.first_name for child in vm.childList.list">
            <option value="" selected disabled>Select</option>
        </select>
    </div>
    <!-- self.trackEvent = function(child_id, notes, category_id, familyId, datetime) -->
    <div class="events-wrapper">
        <div class="event-row">
            <ul>
                <li ng-repeat="feeding in vm.categoryFeeding.list">
                    <button class="btn btn-alt" ng-if="vm.showFeedingTrackingButton = true;" ng-click="vm.showNewFeedingEvent = true; vm.showFeedingTrackingButton = false;">Track New Feeding</button>
                    <div class="new-event" ng-if="vm.showNewFeedingEvent">
                        <h2>Track More Information?</h2>
                        <p ng-click="vm.trackEvent(feeding.child_id, vm.feedingNotes, feeding.id, date); vm.showNewFeedingEvent = false; vm.showFeedingTrackingButton = true;">No, track this event without notes</p>
                        <p ng-click="vm.showNewFeedingNotes = true">Yes</p>
                        <textarea cols="30" rows="10" ng-model="vm.feedingNotes" ng-if="vm.showNewFeedingNotes"></textarea>
                        <button class="btn btn-alt" ng-if="vm.showNewFeedingNotes" ng-click="vm.trackEvent(feeding.child_id, 'null', feeding.id, date); vm.showNewFeedingNotes = false; vm.showFeedingTrackingButton = true; vm.showNewFeedingEvent = false;">Submit Feeding</button>
                        <button class="btn btn-warn" ng-if="vm.showNewFeedingNotes" ng-click="vm.showNewFeedingEvent = false;vm.showFeedingTrackingButton = true;">Cancel Tracking Feeding</button>
                    </div>

                    <h2 class="event-header">{{feeding.category_name}}</h2>
                    <p>Last fed: {{feeding.datetime | date:'h:mm a'}} <!--({{vm.feedingTimeDifferenceInHours}} hours ago) --></p>
                    <p>Notes: {{feeding.notes}} <strong ng-click="vm.editFeedingNotes = true" class="edit-btn">Edit Notes</strong></p>
                    <div class="update-notes" ng-if="vm.editFeedingNotes">
                        <textarea cols="30" rows="10" ng-model="vm.feedingNotesContent" placeholder="Update notes"></textarea>
                        <button class="btn btn-alt" ng-click="vm.updateNotes(feeding.id, vm.feedingNotesContent, feeding.child_id); vm.editFeedingNotes = false;">Update Notes</button>
                        <button class="btn btn-warn" ng-click="vm.editFeedingNotes = false">Cancel</button>
                    </div>
                </li>
            </ul>
        </div> <!-- .event-row -->
        <div class="event-row">
            <ul>
                <li ng-repeat="sleeping in vm.categorySleeping.list">
                    <button class="btn btn-alt" ng-if="vm.showSleepingTrackingButton" ng-click="vm.showNewSleepingEvent = true;vm.showSleepingTrackingButton = false;">Track New Sleeping</button>
                    <div class="new-event" ng-if="vm.showNewSleepingEvent">
                        <h2>Track More Information?</h2>
                        <p ng-click="vm.trackEvent(); vm.showNewSleepingEvent = false; vm.showSleepingTrackingButton = true;">No, track this event without notes</p>
                        <p ng-click="vm.showNewSleepingNotes = true">Yes</p>
                        <textarea cols="30" rows="10" ng-if="vm.showNewSleepingNotes"></textarea>
                        <button class="btn btn-alt" ng-if="vm.showNewSleepingNotes" ng-click="vm.trackEvent(); vm.showNewSleepingNotes = false; vm.showSleepingTrackingButton = true; vm.showNewSleepingEvent = false;">Submit Sleeping</button>
                        <button class="btn btn-warn" ng-if="vm.showNewSleepingNotes" ng-click="vm.showNewSleepingEvent = false;vm.showSleepingTrackingButton = true;">Cancel Tracking Sleeping</button>
                    </div>
    
                    <h2 class="event-header">{{sleeping.category_name}}</h2>
                    <p>Last slept: {{sleeping.datetime | date:'h:mm a'}}</p>
                    <p>Notes: {{sleeping.notes}} <strong ng-click="vm.editSleepingNotes = true" class="edit-btn">Edit Notes</strong></p>
                    <div class="update-notes" ng-if="vm.editSleepingNotes">
                        <textarea cols="30" rows="10" ng-model="vm.sleepingNotesContent" placeholder="Update notes"></textarea>
                        <button class="btn btn-alt" ng-click="vm.updateNotes(sleeping.id, vm.sleepingNotesContent, sleeping.child_id);vm.editSleepingNotes = false;">Update Notes</button>
                        <button class="btn btn-warn" ng-click="vm.editSleepingNotes = false">Cancel</button>
                    </div>
                </li>
            </ul>
        </div> <!-- .event-row -->
        <div class="event-row">
            <ul>
                <li ng-repeat="diapering in vm.categoryDiapering.list">
                    <button class="btn btn-alt" ng-if="vm.showDiaperingTrackingButton" ng-click="vm.showNewDiaperingEvent = true;vm.showDiaperingTrackingButton = false;">Track New Diapering</button>
                    <div class="new-event" ng-if="vm.showNewDiaperingEvent">
                        <h2>Track More Information?</h2>
                        <p ng-click="vm.trackEvent(); vm.showNewDiaperingEvent = false; vm.showDiaperingTrackingButton = true;">No, track this event without notes</p>
                        <p ng-click="vm.showNewDiaperingNotes = true">Yes</p>
                        <textarea cols="30" rows="10" ng-if="vm.showNewDiaperingNotes"></textarea>
                        <button class="btn btn-alt" ng-if="vm.showNewDiaperingNotes" ng-click="vm.trackEvent(); vm.showNewDiaperingNotes = false; vm.showDiaperingTrackingButton = true; vm.showNewDiaperingEvent = false;">Submit Diapering</button>
                        <button class="btn btn-warn" ng-if="vm.showNewDiaperingNotes" ng-click="vm.showNewDiaperingEvent = false;vm.showDiaperingTrackingButton = true;">Cancel Tracking Diapering</button>
                    </div>

                    <h2 class="event-header">{{diapering.category_name}}</h2>
                    <p>Last diapered: {{diapering.datetime | date: MM/dd/YYYY}} {{diapering.datetime | date:'h:mm a'}}</p>
                    <p>Notes: {{diapering.notes}} <strong ng-click="vm.editDiaperingNotes = true" class="edit-btn">Edit Notes</strong></p>
                    <div class="update-notes" ng-if="vm.editDiaperingNotes">
                        <textarea cols="30" rows="10" ng-model="vm.diaperingNotesContent" placeholder="Update notes"></textarea>
                        <button class="btn btn-alt" ng-click="vm.updateNotes(diapering.id, vm.diaperingNotesContent, diapering.child_id);vm.editDiaperingNotes = false;">Update Notes</button>
                        <button class="btn btn-warn" ng-click="vm.editDiaperingNotes = false">Cancel</button>
                    </div>
                </li>
            </ul>
        </div> <!-- .event-row -->
        <div class="event-row">
            <ul>
                <li ng-repeat="medication in vm.categoryMedication.list">
                    <button class="btn btn-alt" ng-if="vm.showMedicationTrackingButton" ng-click="vm.showNewMedicationEvent = true;vm.showMedicationTrackingButton = false;">Track New Medication</button>
                    <div class="new-event" ng-if="vm.showNewMedicationEvent">
                        <h2>Track More Information?</h2>
                        <p ng-click="vm.trackEvent(); vm.showNewMedicationEvent = false; vm.showMedicationTrackingButton = true;">No, track this event without notes</p>
                        <p ng-click="vm.showNewMedicationNotes = true">Yes</p>
                        <textarea cols="30" rows="10" ng-if="vm.showNewMedicationNotes"></textarea>
                        <button class="btn btn-alt" ng-if="vm.showNewMedicationNotes" ng-click="vm.trackEvent(); vm.showNewMedicationNotes = false; vm.showMedicationTrackingButton = true; vm.showNewMedicationEvent = false;">Submit Medication</button>
                        <button class="btn btn-warn" ng-if="vm.showNewMedicationNotes" ng-click="vm.showNewMedicationEvent = false;vm.showMedicationTrackingButton = true;">Cancel Tracking Medication</button>
                    </div>

                    <h2 class="event-header">{{medication.category_name}}</h2>
                    <p>Last medication: {{medication.datetime | date:'h:mm a'}}</p>
                    <p>Notes: {{medication.notes}} <strong ng-click="vm.editMedicationNotes = true" class="edit-btn">Edit Notes</strong></p>
                    <div class="update-notes" ng-if="vm.editMedicationNotes">
                        <textarea cols="30" rows="10" ng-model="vm.medicationNotesContent" placeholder="Update notes"></textarea>
                        <button class="btn btn-alt" ng-click="vm.updateNotes(medication.id, vm.medicationNotesContent, medication.child_id);vm.editMedicationNotes = false;">Update Notes</button>
                        <button class="btn btn-warn" ng-click="vm.editMedicationNotes = false">Cancel</button>
                    </div>
                </li>
            </ul>
        </div> <!-- .event-row -->
        <div class="event-row">
            <ul>
                <li ng-repeat="other in vm.categoryOther.list">
                        <button class="btn btn-alt" ng-if="vm.showOtherTrackingButton" ng-click="vm.showNewOtherEvent = true;vm.showOtherTrackingButton = false;">Track New Other</button>
                        <div class="new-event" ng-if="vm.showNewOtherEvent">
                            <h2>Track More Information?</h2>
                            <p ng-click="vm.trackEvent(); vm.showNewOtherEvent = false; vm.showOtherTrackingButton = true;">No, track this event without notes</p>
                            <p ng-click="vm.showNewOtherNotes = true">Yes</p>
                            <textarea cols="30" rows="10" ng-if="vm.showNewOtherNotes"></textarea>
                            <button class="btn btn-alt" ng-if="vm.showNewOtherNotes" ng-click="vm.trackEvent(); vm.showNewOtherNotes = false; vm.showOtherTrackingButton = true; vm.showNewOtherEvent = false;">Submit Other</button>
                            <button class="btn btn-warn" ng-if="vm.showNewOtherNotes" ng-click="vm.showNewOtherEvent = false;vm.showOtherTrackingButton = true;">Cancel Tracking Other</button>
                        </div>

                    <h2 class="event-header">{{other.category_name}}</h2>
                    <p>Last other: {{other.datetime | date:'h:mm a'}}</p>
                    <p>Notes: {{other.notes}} <strong ng-click="vm.editOtherNotes = true" class="edit-btn">Edit Notes</strong></p>
                    <div class="update-notes" ng-if="vm.editOtherNotes">
                        <textarea cols="30" rows="10" ng-model="vm.otherNotesContent" placeholder="Update notes"></textarea>
                        <button class="btn btn-alt" ng-click="vm.updateNotes(other.id, vm.otherNotesContent, other.child_id); vm.editOtherNotes = false;">Update Notes</button>
                        <button class="btn btn-warn" ng-click="vm.editOtherNotes = false">Cancel</button>
                    </div>
                </li>
            </ul>
        </div> <!-- .event-row -->
    </div>


<!-- <h2>EVENT TABLE: </h2>
<table class="event-table">
    <thead>
        <tr>
            <th>Date</th>
            <th>Time</th>
            <th>Notes</th>
            <th>Category</th>
        </tr>
    </thead>
    <tbody>
        <tr ng-repeat="childEvent in vm.childEvents.list">
            <td>{{childEvent.datetime | date: MM/dd/YYYY}}</td>
            <td>{{childEvent.datetime | date:'h:mm a'}}</td>
            <td>{{childEvent.notes}}</td>
            <td>{{childEvent.category_name}}</td>
        </tr>
    </tbody>
</table> -->
</div> <!-- .track-wrapper -->

